% Yagfarov Rauf
% Mamakov Timur
% Innopolis University

%this function was generated by Neural Network Toolbox
function [y1] = myNeuralNetworkFunction(x1)

% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = Qx17 matrix, input #1
% and returns:
%   y = Qx8 matrix, output #1
% where Q is the number of samples.

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [34.4339321357285;33.4790874524715;31.443237370994;13.6412696398306;15.0974599720953;14.6603973834239;9205;411.297;0.332714221034115;133.42353101479;76.2261246346148;5.46436415121687;5.20950813435152;5.13714113147844;3.2867022796688e-06;3.30683654345743e-06;3.32244578610406e-06];
x1_step1_gain = [0.0244604999187401;0.0395562141532833;0.0642072107368788;0.0576993135541228;0.0598397212809293;0.0597925886598885;0.000104248110502997;0.00511520725540997;3.51133822115947;0.0194235568401265;0.0210645746478137;1.73513420901541;1.61550004285967;1.85353073670015;14501688.5042401;13907395.6796249;15408623.8187868];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.75164531670002820984;-0.72168349582628865679;-2.0066625016665455838;1.6170304567840152465;-0.29519577076414477146;1.2095858499799101438;2.2077284327016148957;0.61601916707383175265;2.1918783140737834181;-0.13618870210320771497];
IW1_1 = [1.9049756993764803692 0.85981013547538542863 -1.2795516766667549557 0.28055750149965191786 0.43144065074275811389 2.0487152559752792591 0.062503636291731917707 -0.26544136038925808529 1.0098588401679331472 -0.52530673971600017058 0.15834186932565977313 1.0253301614699854571 2.5503591070236191207 -1.7327161579980061568 -2.6422358393723612835 -1.9672645328891908978 0.29345854786129976777;0.47270673522428369173 -0.30039972341249931986 0.89050312109335882926 -0.47181628118004986794 0.55285270229533534092 -0.20248019122309313111 0.79038691448350095747 -0.074884602557199669848 1.9760103811936926554 1.7931581925112549669 -0.80644895581074260704 -0.12168080894575683537 -0.05959404602232644399 -0.7602311657195182093 -1.2937881886675473009 -1.4903870247894501766 -1.8407731939993743353;1.264748474652990673 -0.50351863902983118315 -0.72204463011603858824 0.03568378539017972445 0.38608470165394154217 0.20989326672468824886 0.96057025839927734356 0.28696881905451104844 1.6348620214681170992 2.6385563120952846283 -0.8365337918969922848 2.6444917503974405548 0.0809968773655601465 -2.1257173769781654293 -1.9379628683942402567 -0.0062505570403059776408 0.0057851843263526103733;-0.19691899522608544149 0.09844707387908697982 0.55949867263376806825 -0.62935600377095768376 0.19237653467095947035 -0.40343470380864482339 -1.5784135328424473421 0.42455441516751374342 1.6393081971607472713 -0.26526651263121464597 -1.669988958993891659 -0.64059852025865571257 -0.18323154476365971499 -0.48165403435786774411 -1.3154168161360757505 -1.7412214991284074017 -2.763061319547488015;0.83173883889939725922 1.9712602995007824092 1.278821043950874925 0.18281663698161881859 0.67236384777773139376 0.76344803591814336396 -1.3219323241602729535 -0.40024140833422933161 -1.4135235604141351828 -1.4826129598626442974 0.072114260456448031622 -2.1869004615932285951 -0.6467326856252502143 -1.0101949984936469118 -0.40542167858991784435 -1.9792095415582637852 -0.87413101544157978395;0.46600584085352209085 -0.73946599530793888366 0.47454243053302763711 -0.48211992817986926152 -2.1896674838518963568 -1.8296301126572280804 1.198621276731977936 1.861957324742454345 0.31975342939806905562 1.6289401513904955277 0.84574088974985262013 -1.1927601356469035299 1.5910691127016256541 0.51293788139274809623 1.6242011065510471024 0.817518626967813411 1.0582045809644260448;2.4336341664371654581 0.44617148343036322489 -0.54540865432311425032 -1.9728293722281486922 -0.16332195497519247374 0.20125390985518412656 0.47814427697281342011 0.25915918907412754946 -1.1973405741744325148 -0.35878858529001689259 1.60087980339068503 2.8244184941990875259 -0.1293438928924271758 -1.7410230986045638346 -3.2598390335062781276 0.75719455996814977183 1.6291499509264308898;0.62397282062542369641 -0.64025172261090890213 0.050407970866790927089 -0.28025699097460687881 -0.03571388268101621799 0.10519128198979960098 0.12126431166660829597 1.3369384630866991692 1.490486527265279415 1.7532587151909502232 -0.93180615976937475331 1.0667360689280231956 0.71972549217945702704 -0.37479382907317754237 0.10572622228692567237 0.68044879401349611658 0.82365497181204128108;1.7774085501833698508 0.47641504128461575895 1.0764322313395116026 -1.5704902000254667982 -1.187120276660182272 -1.1154993750623445337 2.1477477823202129059 0.35401503439761894398 -0.4243792301929937838 2.1902677253956044368 1.9675795383300809238 0.73192943716684499833 0.088485516988334456112 0.682609084154661927 -0.30694173668120094955 0.64954692677912440057 1.2403319009266946527;-0.16906304994336315839 -0.27875398568386933196 -0.9136799261171290043 0.84310376603277048524 0.27549872122226526372 -0.83508377150431800651 -1.0824977389334280442 -0.70450593053711563218 -1.5758811265187882 -2.4864009815681593629 -0.18697422046872516632 1.0622362696113889502 2.565892591708824888 0.49077736697069196392 -0.16895882823016633578 0.14810364088510447056 0.77958849934004503801];

% Layer 2
b2 = [0.48034120894247861466;-0.17425923858547170964;1.0792344284115302777;0.29107872763135622662;0.45733865553644176272;-0.61195773482640958285;0.75134605891413053236;0.10478672101798000571];
LW2_1 = [3.0202727486773026655 0.67313741609420096879 -3.1913008987800384197 0.55402558358658804405 3.6224064622317957429 -0.09070550416116639203 1.4436534480349478837 -1.2289687286550858847 0.75771189104022718119 1.6202775098072823567;2.3756372029560299808 1.7790266873529230196 1.5232829858647216614 2.666595882068836687 0.74268426663603825943 -0.66426448640658142253 -5.0535814822625013676 0.67375319639815467454 -3.6702142235080210675 0.2410644153810133361;-2.7380543889370678734 -0.44784722201708682121 -3.7264220741530569292 1.3727898600787389327 -1.0521901901136647695 1.3349319035733400174 -2.4052394190939927476 0.892708769866467855 1.1444621674312427384 -1.1155331197424214196;-0.66136428019273341139 -0.4148927081417351781 -1.8338705860705808437 1.8248739993386524638 -2.8876612853234964184 -3.9878694334008546463 -2.5128331876481300178 0.72843548649365830183 -0.74457400611476343144 -1.895697757648202364;5.1209527231058276087 -0.058948610367363790674 1.651012211826488274 1.0197171673835399019 -1.4786998064947549647 0.29762309482655097126 3.5101692454774742203 0.5883086276872985243 -0.55803616765108010611 2.2325912194027783819;-1.6411198133049578196 -1.3757506304596753832 -2.4258401982963553323 -1.0673795784993542757 0.77358664578127811495 -0.0027269785944556666768 -1.3457239614629408209 -1.8816721770809992087 -4.5283544217678031174 3.3699511249871219043;-4.3535582686135168018 2.0071306101407651035 0.52602413250844315407 -1.8068851091743067805 -1.6980182041097684476 1.5660144926616619276 0.98059454693908210121 -0.074040015998553171395 3.3628239064060170271 -2.0347252505805459855;-0.46212757724252317981 -0.59788412943011459699 3.4835568963624998773 -3.1718974135443640527 -1.6349316405496379101 0.98985359139952566743 4.7509890391603368798 0.22389856052418677379 1.7785950814143314247 -0.92202685167936304644];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,1); % samples

% Input 1
x1 = x1';
xp1 = mapminmax_apply(x1,x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);

% Output 1
y1 = a2;
y1 = y1';
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numer = exp(n);
denom = sum(numer,1);
denom(denom == 0) = 1;
a = bsxfun(@rdivide,numer,denom);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
